import{system}from"@minecraft/server";import{secondsToTicks,randInt}from"./libs/utils";import{bVector3}from"./libs/better_vectors";const DATA={id:"hfrlc:pumpkinkido",killed_check_delay:secondsToTicks(1),dancing:{anim_time:secondsToTicks(7.5),min_time:1,max_time:2}};export function onAttack(t){const{damagingEntity:e,hitEntity:i}=t;if(e.typeId===DATA.id){const t=i?.getComponent("minecraft:health"),n=e?.getRotation().y;t?.currentValue<=0&&(e?.setProperty("hfrlc:rotation",n),e?.setProperty("hfrlc:rotation_locked",!0),system.runTimeout(()=>{if(!e.getProperty("hfrlc:has_target")){e?.setDynamicProperty("hfrlc:target_dead",!0);const t=randInt(DATA.dancing.min_time,DATA.dancing.max_time)*DATA.dancing.anim_time;e?.triggerEvent("hfrlc:start_dancing"),system.runTimeout(()=>{e?.setRotation({x:0,y:n}),e?.triggerEvent("hfrlc:stop_dancing"),e?.setProperty("hfrlc:rotation_locked",!1)},t)}},DATA.killed_check_delay))}}export function onEvent(t){t.entity.typeId!==DATA.id&&t.entity.typeId!==DATA.baby_id||("minecraft:entity_spawned"!==t.eventId&&"hfrlc:buried"!==t.eventId||t.entity&&t.entity?.isValid()&&(t.entity.setRotation({x:0,y:0}),t.entity.setProperty("hfrlc:rotation",0)),"hfrlc:death"===t.eventId&&t.entity&&t.entity?.isValid()&&!t.entity.getProperty("hfrlc:rotation_locked")&&(t.entity.setProperty("hfrlc:rotation",t.entity.getRotation().y),t.entity.setProperty("hfrlc:rotation_locked",!0)))}function getDirection(t,e){let i=bVector3.fromVector3(t.location),n=bVector3.fromVector3(e.location);return bVector3.subtract(i,n)}