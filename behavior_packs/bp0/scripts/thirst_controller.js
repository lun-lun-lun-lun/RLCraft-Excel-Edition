import{system,world,EntityEquippableComponent,EquipmentSlot,ItemStack}from"@minecraft/server";import{addScore,setScore,getScore}from"./functions.js";const THIRST_BARS=[{max:36e3,event:"hfrlc:thirstbar20"},{max:34200,event:"hfrlc:thirstbar19"},{max:32400,event:"hfrlc:thirstbar18"},{max:30600,event:"hfrlc:thirstbar17"},{max:28800,event:"hfrlc:thirstbar16"},{max:27e3,event:"hfrlc:thirstbar15"},{max:25200,event:"hfrlc:thirstbar14"},{max:23400,event:"hfrlc:thirstbar13"},{max:21600,event:"hfrlc:thirstbar12"},{max:19800,event:"hfrlc:thirstbar11"},{max:18e3,event:"hfrlc:thirstbar10"},{max:16200,event:"hfrlc:thirstbar9"},{max:14400,event:"hfrlc:thirstbar8"},{max:12600,event:"hfrlc:thirstbar7"},{max:10800,event:"hfrlc:thirstbar6"},{max:9e3,event:"hfrlc:thirstbar5"},{max:7200,event:"hfrlc:thirstbar4"},{max:5400,event:"hfrlc:thirstbar3"},{max:3600,event:"hfrlc:thirstbar2"},{max:1800,event:"hfrlc:thirstbar1"},{max:0,event:"hfrlc:thirstbar0"}],DRAIN_SPEEDS=[{temperature:[0,1],workState:0,drain:2},{temperature:[0,1],workState:1,drain:4},{temperature:[0,1],workState:2,drain:5},{temperature:[2,2],workState:0,drain:3},{temperature:[2,2],workState:1,drain:6},{temperature:[2,2],workState:2,drain:7}];function updateThirstBar(t,r){const e=THIRST_BARS.find(t=>r>=t.max);e&&(t.hasTag("used")||t.hasTag("desactive_thirst")||t.triggerEvent(e.event))}function calculateDrainSpeed(t){const r=getScore(t,"temperature"),e=getScore(t,"workstate"),a=DRAIN_SPEEDS.find(t=>r>=t.temperature[0]&&r<=t.temperature[1]&&e===t.workState);return a?a.drain:0}function drainThirst(t,r){if(!t.hasTag("dead_thirst")){r-=calculateDrainSpeed(t),r=Math.max(r,0),setScore(t,"thirst",r),t.isInWater&&r<38e3&&addScore(t,"thirst",1800),r>38e3?setScore(t,"thirst",38e3):r<0&&setScore(t,"thirst",0)}}export function updateThirst(t){if(t.hasTag("desactive_thirst"))return;let r=getScore(t,"thirst");const e=t.getGameMode();"spectator"!=e&&"creative"!=e&&(drainThirst(t,r),updateThirstBar(t,r))}