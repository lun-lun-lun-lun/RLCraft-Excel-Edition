import{system,world,BlockVolume}from"@minecraft/server";import{temp_sphere}from"./temp_sphere.js";import{tempArrow}from"./temp_arrow.js";import{TempScore}from"./temp_detect.js";function getTempBlocks(e){const o=[{condition:()=>checkTempBlocks(e,heatBlocks)||e.hasTag("on_fire"),tag:"near_heatsource"},{condition:()=>checkTempBlocks(e,coolBlocks),tag:"near_coldsource"}];for(const t of o){const o=t.condition(),r=e.hasTag(t.tag);o&&!r?e.addTag(t.tag):!o&&r&&e.removeTag(t.tag)}}function checkTempBlocks(e,o){const{x:t,y:r,z:c}=e.location,{min:a,max:n}=e.dimension.heightRange;if(r>n||r<a)return;const s={x:t-range,y:r-range,z:c-range},i={x:t+range,y:r+range,z:c+range},l=e.dimension.getBlocks(new BlockVolume(s,i),{includeTypes:o},!0);for(let e of l.getBlockLocationIterator())return!0;return!1}system.runInterval(async()=>{for(const e of world.getPlayers()){const o=e.getGameMode();"spectator"!=o&&"creative"!=o&&e.hasTag("active_temp")&&(getTempBlocks(e),temp_sphere(e),tempArrow(e)),await system.waitTicks(1)}},80);const range=1,heatBlocks=["beacon","fire","glowstone","lit_pumpkin","lantern","lava","flowing_lava","campfire","shroomlight","torch","lit_furnace","lit_blast_furnace","lit_smoker","soul_campfire","soul_fire","soul_lantern","soul_torch","magma"],coolBlocks=["snow","snow_layer","ice","packed_ice","blue_ice","frosted_ice","powder_snow"];