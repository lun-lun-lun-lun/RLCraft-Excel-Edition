import{ItemStack,GameMode}from"@minecraft/server";const maxGrowthStage=4,fruitGrowthStage=5;export function onStartup(t){t.blockComponentRegistry.registerCustomComponent("hfrlc:custom_bush",{onPlayerInteract(t){onPlayerInteract(t)},onTick(t){advanceGrowthStage(t.block)}}),t.blockComponentRegistry.registerCustomComponent("hfrlc:custom_bush_fruit",{onPlayerInteract(t){harvestFruit(t)}})}function onPlayerInteract(t){const{block:e,player:n}=t,{x:o,y:r,z:a}=e.location,c=n.getComponent("equippable"),i=c.getEquipment("Mainhand");if(i&&"minecraft:bone_meal"===i.typeId){n.playAnimation("animation.hfrlc.use_item");const s=e.permutation,m=s.getState("hfrlc:growth_stage");if(m<=3){t.cancel=!0,e.dimension.playSound("block.sweet_berry_bush.place",e.center());const u=m+1,h=s.withState("hfrlc:growth_stage",u);e.setPermutation(h),e.dimension.spawnParticle("minecraft:crop_growth_emitter",{x:o+.5,y:r+.5,z:a+.5}),n.getGameMode()!==GameMode.creative&&(i.amount>1?(i.amount-=1,c.setEquipment("Mainhand",i)):c.setEquipment("Mainhand",void 0))}}}function advanceGrowthStage(t){if("hfrlc:blue_bush"!==t.typeId&&"hfrlc:orange_bush"!==t.typeId)return;const e=t.permutation,n=e.getState("hfrlc:growth_stage")??1,o=5===n?n-1:n+1,r=e.withState("hfrlc:growth_stage",o);t.setPermutation(r)}function harvestFruit(t){const{block:e,player:n}=t,o=e.permutation,r=o.getState("hfrlc:growth_stage");t.cancel=!0;const a=o.withState("hfrlc:growth_stage",r+1);e.setPermutation(a);const c=new ItemStack(`${e.typeId}_fruit`);e.dimension.spawnItem(c,e.center()),e.dimension.playSound("block.sweet_berry_bush.pick",e.center())}